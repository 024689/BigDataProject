[2024-01-30T03:05:00.347+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: manage_data_lake_dag.extract_data_and_load_to_gs manual__2024-01-30T03:04:50.630122+00:00 [queued]>
[2024-01-30T03:05:00.352+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: manage_data_lake_dag.extract_data_and_load_to_gs manual__2024-01-30T03:04:50.630122+00:00 [queued]>
[2024-01-30T03:05:00.352+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 6
[2024-01-30T03:05:00.365+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): extract_data_and_load_to_gs> on 2024-01-30 03:04:50.630122+00:00
[2024-01-30T03:05:00.369+0000] {standard_task_runner.py:60} INFO - Started process 23534 to run task
[2024-01-30T03:05:00.375+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'manage_data_lake_dag', 'extract_data_and_load_to_gs', 'manual__2024-01-30T03:04:50.630122+00:00', '--job-id', '140', '--raw', '--subdir', 'DAGS_FOLDER/data_lake_dag.py', '--cfg-path', '/tmp/tmptfkknn2c']
[2024-01-30T03:05:00.378+0000] {standard_task_runner.py:88} INFO - Job 140: Subtask extract_data_and_load_to_gs
[2024-01-30T03:05:00.419+0000] {task_command.py:423} INFO - Running <TaskInstance: manage_data_lake_dag.extract_data_and_load_to_gs manual__2024-01-30T03:04:50.630122+00:00 [running]> on host instance-1.europe-west9-a.c.data-lake-project-409321.internal
[2024-01-30T03:05:00.495+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='juniortemgoua0' AIRFLOW_CTX_DAG_ID='manage_data_lake_dag' AIRFLOW_CTX_TASK_ID='extract_data_and_load_to_gs' AIRFLOW_CTX_EXECUTION_DATE='2024-01-30T03:04:50.630122+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-01-30T03:04:50.630122+00:00'
[2024-01-30T03:05:00.733+0000] {logging_mixin.py:188} INFO - Login to bucket data-lake-buck
[2024-01-30T03:05:01.231+0000] {logging_mixin.py:188} INFO - File was send successfully as /data-lake/raw/football_data/competitions/2024-01-30/BSA.json
[2024-01-30T03:05:01.232+0000] {client.py:192} INFO - Instantiated <InsecureClient(url='http://localhost:9870')>.
[2024-01-30T03:05:01.232+0000] {client.py:551} INFO - Uploading 'temp.json' to '/data-lake/raw/football_data/competitions/2024-01-30/BSA.json'.
[2024-01-30T03:05:01.233+0000] {client.py:1116} INFO - Listing '/data-lake/raw/football_data/competitions/2024-01-30/BSA.json'.
[2024-01-30T03:05:02.086+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/hdfs/client.py", line 580, in upload
    statuses = [status for _, status in self.list(hdfs_path, status=True)]
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/hdfs/client.py", line 1118, in list
    statuses = self._list_status(hdfs_path).json()['FileStatuses']['FileStatus']
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/hdfs/client.py", line 118, in api_handler
    raise err
hdfs.util.HdfsError: b'<html>\n<head>\n<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1"/>\n<title>Error 500 java.lang.NoClassDefFoundError: Could not initialize class com.sun.xml.bind.v2.runtime.reflect.opt.Injector</title>\n</head>\n<body><h2>HTTP ERROR 500 java.lang.NoClassDefFoundError: Could not initialize class com.sun.xml.bind.v2.runtime.reflect.opt.Injector</h2>\n<table>\n<tr><th>URI:</th><td>/webhdfs/v1/data-lake/raw/football_data/competitions/2024-01-30/BSA.json</td></tr>\n<tr><th>STATUS:</th><td>500</td></tr>\n<tr><th>MESSAGE:</th><td>java.lang.NoClassDefFoundError: Could not initialize class com.sun.xml.bind.v2.runtime.reflect.opt.Injector</td></tr>\n<tr><th>SERVLET:</th><td>com.sun.jersey.spi.container.servlet.ServletContainer-ea9b7c6</td></tr>\n<tr><th>CAUSED BY:</th><td>java.lang.NoClassDefFoundError: Could not initialize class com.sun.xml.bind.v2.runtime.reflect.opt.Injector</td></tr>\n<tr><th>CAUSED BY:</th><td>java.lang.ExceptionInInitializerError: Exception java.lang.reflect.InaccessibleObjectException: Unable to make protected final java.lang.Class java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int) throws java.lang.ClassFormatError accessible: module java.base does not &quot;opens java.lang&quot; to unnamed module @5a6d67c3 [in thread &quot;qtp120689887-23&quot;]</td></tr>\n</table>\n<h3>Caused by:</h3><pre>java.lang.NoClassDefFoundError: Could not initialize class com.sun.xml.bind.v2.runtime.reflect.opt.Injector\n\tat com.sun.xml.bind.v2.runtime.reflect.opt.AccessorInjector.prepare(AccessorInjector.java:83)\n\tat com.sun.xml.bind.v2.runtime.reflect.opt.OptimizedAccessorFactory.get(OptimizedAccessorFactory.java:176)\n\tat com.sun.xml.bind.v2.runtime.reflect.Accessor$FieldReflection.optimize(Accessor.java:282)\n\tat com.sun.xml.bind.v2.runtime.property.ArrayProperty.&lt;init&gt;(ArrayProperty.java:69)\n\tat com.sun.xml.bind.v2.runtime.property.ArrayERProperty.&lt;init&gt;(ArrayERProperty.java:88)\n\tat com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.&lt;init&gt;(ArrayElementProperty.java:100)\n\tat com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.&lt;init&gt;(ArrayElementNodeProperty.java:62)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)\n\tat com.sun.xml.bind.v2.runtime.property.PropertyFactory.create(PropertyFactory.java:128)\n\tat com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.&lt;init&gt;(ClassBeanInfoImpl.java:183)\n\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl.getOrCreate(JAXBContextImpl.java:532)\n\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl.&lt;init&gt;(JAXBContextImpl.java:347)\n\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder.build(JAXBContextImpl.java:1170)\n\tat com.sun.xml.bind.v2.ContextFactory.createContext(ContextFactory.java:145)\n\tat com.sun.xml.bind.v2.ContextFactory.createContext(ContextFactory.java:236)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\n\tat javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:186)\n\tat javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:146)\n\tat javax.xml.bind.ContextFinder.find(ContextFinder.java:350)\n\tat javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:446)\n\tat javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:409)\n\tat com.sun.jersey.server.impl.wadl.WadlApplicationContextImpl.&lt;init&gt;(WadlApplicationContextImpl.java:103)\n\tat com.sun.jersey.server.impl.wadl.WadlFactory.init(WadlFactory.java:100)\n\tat com.sun.jersey.server.impl.application.RootResourceUriRules.initWadl(RootResourceUriRules.java:169)\n\tat com.sun.jersey.server.impl.application.RootResourceUriRules.&lt;init&gt;(RootResourceUriRules.java:106)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl._initiate(WebApplicationImpl.java:1359)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl.access$700(WebApplicationImpl.java:180)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:799)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:795)\n\tat com.sun.jersey.spi.inject.Errors.processWithErrors(Errors.java:193)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:795)\n\tat com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:790)\n\tat com.sun.jersey.spi.container.servlet.ServletContainer.initiate(ServletContainer.java:509)\n\tat com.sun.jersey.spi.container.servlet.ServletContainer$InternalWebComponent.initiate(ServletContainer.java:339)\n\tat com.sun.jersey.spi.container.servlet.WebComponent.load(WebComponent.java:605)\n\tat com.sun.jersey.spi.container.servlet.WebComponent.init(WebComponent.java:207)\n\tat com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:394)\n\tat com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:577)\n\tat javax.servlet.GenericServlet.init(GenericServlet.java:244)\n\tat org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:632)\n\tat org.eclipse.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:486)\n\tat org.eclipse.jetty.servlet.ServletHolder.prepare(ServletHolder.java:759)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:549)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:516)\n\tat org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)\n\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)\n\tat org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: java.lang.ExceptionInInitializerError: Exception java.lang.reflect.InaccessibleObjectException: Unable to make protected final java.lang.Class java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int) throws java.lang.ClassFormatError accessible: module java.base does not &quot;opens java.lang&quot; to unnamed module @5a6d67c3 [in thread &quot;qtp120689887-23&quot;]\n\tat java.base/java.lang.reflect.AccessibleObject.checkCanSetAccessible(AccessibleObject.java:354)\n\tat java.base/java.lang.reflect.AccessibleObject.checkCanSetAccessible(AccessibleObject.java:297)\n\tat java.base/java.lang.reflect.Method.checkCanSetAccessible(Method.java:199)\n\tat java.base/java.lang.reflect.Method.setAccessible(Method.java:193)\n\tat com.sun.xml.bind.v2.runtime.reflect.opt.Injector$1.run(Injector.java:177)\n\tat com.sun.xml.bind.v2.runtime.reflect.opt.Injector$1.run(Injector.java:174)\n\tat java.base/java.security.AccessController.doPrivileged(AccessController.java:318)\n\tat com.sun.xml.bind.v2.runtime.reflect.opt.Injector.&lt;clinit&gt;(Injector.java:172)\n\t... 81 more\n</pre>\n\n</body>\n</html>\n'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/juniortemgoua0/DataLake/jobs/extractions/python/sources/football_data/football_data_service.py", line 133, in extract_data_and_load_to_gs
    find_competitions(bucket, current_date)
  File "/home/juniortemgoua0/DataLake/jobs/extractions/python/sources/football_data/football_data_service.py", line 39, in find_competitions
    send_file_to_hdfs(json_data=comp_res_data,
  File "/home/juniortemgoua0/DataLake/jobs/extractions/python/sources/utils/hdfs_service.py", line 14, in send_file_to_hdfs
    client.upload(hdfs_path, local_temp_file, overwrite=True)
  File "/home/juniortemgoua0/DataLake/venv/lib/python3.8/site-packages/hdfs/client.py", line 582, in upload
    if 'not a directory' in err.message:
TypeError: a bytes-like object is required, not 'str'
[2024-01-30T03:05:02.095+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=manage_data_lake_dag, task_id=extract_data_and_load_to_gs, execution_date=20240130T030450, start_date=20240130T030500, end_date=20240130T030502
[2024-01-30T03:05:02.107+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 140 for task extract_data_and_load_to_gs (a bytes-like object is required, not 'str'; 23534)
[2024-01-30T03:05:02.152+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-01-30T03:05:02.171+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
